(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{2120:(e,r,t)=>{"use strict";t.d(r,{A:()=>g});var a=t(8526),o=t(5806),s=t(718),i=t(4610),n=t(9758),l=t(3653),c=t(5184),d=t(9900);function h(e){return(0,d.Ay)("MuiCard",e)}(0,c.A)("MuiCard",["root"]);var u=t(8481);let m=(0,i.Ay)(l.A,{name:"MuiCard",slot:"Root",overridesResolver:(e,r)=>r.root})({overflow:"hidden"}),g=a.forwardRef(function(e,r){let t=(0,n.b)({props:e,name:"MuiCard"}),{className:a,raised:i=!1,...l}=t,c={...t,raised:i},d=(e=>{let{classes:r}=e;return(0,s.A)({root:["root"]},h,r)})(c);return(0,u.jsx)(m,{className:(0,o.A)(d.root,a),elevation:i?8:void 0,ref:r,ownerState:c,...l})})},2125:(e,r,t)=>{"use strict";t.d(r,{A:()=>v});var a=t(8526),o=t(5806),s=t(718),i=t(4987),n=t(4610),l=t(8348),c=t(9758),d=t(767),h=t(1809),u=t(5184),m=t(9900);function g(e){return(0,m.Ay)("MuiTypography",e)}(0,u.A)("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);var p=t(8481);let x={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},b=(0,i.Dg)(),y=(0,n.Ay)("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,r)=>{let{ownerState:t}=e;return[r.root,t.variant&&r[t.variant],"inherit"!==t.align&&r["align".concat((0,d.A)(t.align))],t.noWrap&&r.noWrap,t.gutterBottom&&r.gutterBottom,t.paragraph&&r.paragraph]}})((0,l.A)(e=>{var r;let{theme:t}=e;return{margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(t.typography).filter(e=>{let[r,t]=e;return"inherit"!==r&&t&&"object"==typeof t}).map(e=>{let[r,t]=e;return{props:{variant:r},style:t}}),...Object.entries(t.palette).filter((0,h.A)()).map(e=>{let[r]=e;return{props:{color:r},style:{color:(t.vars||t).palette[r].main}}}),...Object.entries((null==(r=t.palette)?void 0:r.text)||{}).filter(e=>{let[,r]=e;return"string"==typeof r}).map(e=>{let[r]=e;return{props:{color:"text".concat((0,d.A)(r))},style:{color:(t.vars||t).palette.text[r]}}}),{props:e=>{let{ownerState:r}=e;return"inherit"!==r.align},style:{textAlign:"var(--Typography-textAlign)"}},{props:e=>{let{ownerState:r}=e;return r.noWrap},style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:e=>{let{ownerState:r}=e;return r.gutterBottom},style:{marginBottom:"0.35em"}},{props:e=>{let{ownerState:r}=e;return r.paragraph},style:{marginBottom:16}}]}})),A={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},v=a.forwardRef(function(e,r){let{color:t,...a}=(0,c.b)({props:e,name:"MuiTypography"}),i=!x[t],n=b({...a,...i&&{color:t}}),{align:l="inherit",className:h,component:u,gutterBottom:m=!1,noWrap:v=!1,paragraph:f=!1,variant:w="body1",variantMapping:j=A,...C}=n,N={...n,align:l,color:t,className:h,component:u,gutterBottom:m,noWrap:v,paragraph:f,variant:w,variantMapping:j},M=u||(f?"p":j[w]||A[w])||"span",k=(e=>{let{align:r,gutterBottom:t,noWrap:a,paragraph:o,variant:i,classes:n}=e,l={root:["root",i,"inherit"!==e.align&&"align".concat((0,d.A)(r)),t&&"gutterBottom",a&&"noWrap",o&&"paragraph"]};return(0,s.A)(l,g,n)})(N);return(0,p.jsx)(y,{as:M,ref:r,className:(0,o.A)(k.root,h),...C,ownerState:N,style:{..."inherit"!==l&&{"--Typography-textAlign":l},...C.style}})})},2568:(e,r,t)=>{Promise.resolve().then(t.bind(t,7387))},7387:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>j});var a=t(8481),o=t(8526),s=t(2120),i=t(2125),n=t(8928),l=t(7751),c=t(398),d=t(4116),h=t(3806),u=t(8757),m=t(5319),g=t(5673),p=t(3973),x=t(7661),b=t(129);class y{async getStats(){let{count:e,error:r}=await b.N.from("profiles").select("*",{count:"exact",head:!0});if(r){if("PGRST301"===r.code||r.message.includes("permission denied"))throw Error("Permission denied. Make sure you have admin access and the admin policies are set up correctly.");throw Error(r.message)}let{data:t,error:a}=await b.N.from("profiles").select("role");if(a){if("PGRST301"===a.code||a.message.includes("permission denied"))throw Error("Permission denied. Make sure you have admin access and the admin policies are set up correctly.");throw Error(a.message)}let o=(null==t?void 0:t.filter(e=>"mentor"===e.role).length)||0;return{totalMembers:e||0,mentors:o,mentees:(null==t?void 0:t.filter(e=>"mentee"===e.role).length)||0,execs:(null==t?void 0:t.filter(e=>"admin"===e.role).length)||0}}async searchUserByEmail(e){let{data:r,error:t}=await b.N.from("profiles").select("id, email, first_name, last_name, role").ilike("email",e).limit(1).maybeSingle();if(t){if("PGRST301"===t.code||t.message.includes("permission denied"))throw Error("Permission denied. Make sure you have admin access and the admin policies are set up correctly.");throw Error(t.message)}return r}async updateUserRole(e,r){let{error:t}=await b.N.from("profiles").update({role:r}).eq("id",e);if(t)throw Error(t.message)}async getAllUsers(){let{data:e,error:r}=await b.N.from("profiles").select("id, email, first_name, last_name, role").order("created_at",{ascending:!1});if(r)throw Error(r.message);return e}}let A=new y;class v{async getStats(){try{let e=await A.getStats();return{success:!0,data:e}}catch(e){return{success:!1,error:e instanceof Error?e.message:"An error occurred"}}}async searchUserByEmail(e){try{let r=await A.searchUserByEmail(e);return{success:!0,data:r}}catch(e){return{success:!1,error:e instanceof Error?e.message:"An error occurred"}}}async updateUserRole(e,r){try{return await A.updateUserRole(e,r),{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"An error occurred"}}}async getAllUsers(){try{let e=await A.getAllUsers();return{success:!0,data:e}}catch(e){return{success:!1,error:e instanceof Error?e.message:"An error occurred"}}}}let f=new v;var w=t(2471);function j(){let[e,r]=(0,o.useState)(null),[t,b]=(0,o.useState)(""),[y,A]=(0,o.useState)(null),[v,j]=(0,o.useState)("default"),[C,N]=(0,o.useState)(""),[M,k]=(0,o.useState)(""),[E,R]=(0,o.useState)(!1),S=(0,p.useRouter)(),{userRole:U,isAuthenticated:B}=(0,w.G)(e=>e.user);(0,o.useEffect)(()=>{if(console.log("Admin page - isAuthenticated:",B,"userRole:",U),!B){console.log("Not authenticated, redirecting..."),S.push("/");return}if("admin"!==U){console.log("User role is not admin:",U,"redirecting..."),S.push("/");return}console.log("User is admin, loading stats..."),F()},[B,U,S]);let F=async()=>{try{let e=await f.getStats();if(e.success&&e.data)r(e.data),N("");else{let r=e.error||"Failed to load stats";console.error("Failed to load stats:",r),N(r)}}catch(r){let e=r instanceof Error?r.message:"Unknown error occurred";console.error("Error loading stats:",r),N(e)}},P=async()=>{if(!t.trim())return void N("Please enter an email address");N(""),k(""),R(!0);let e=await f.searchUserByEmail(t.trim());e.success?e.data?(A(e.data),j(e.data.role)):(N("No user found with that email"),A(null)):(N(e.error||"Failed to search user"),A(null)),R(!1)},O=async()=>{if(!y)return void N("Please search for a user first");N(""),k(""),R(!0);let e=await f.updateUserRole(y.id,v);e.success?(k("User role updated to ".concat(v)),A({...y,role:v}),F()):N(e.error||"Failed to update role"),R(!1)};return B&&"admin"===U?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{}),(0,a.jsx)("div",{className:"py-10 px-5",style:{backgroundColor:"#020B2C",minHeight:"100vh"},children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsx)("h1",{className:"mb-8 text-4xl font-semibold text-white text-center",children:"Admin Dashboard"}),e&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,a.jsx)(s.A,{sx:{backgroundColor:"#1F2937",color:"white"},children:(0,a.jsxs)(n.A,{children:[(0,a.jsx)(i.A,{variant:"h6",sx:{color:"#9CA3AF",mb:2},children:"Total Members"}),(0,a.jsx)(i.A,{variant:"h4",sx:{color:"white",fontWeight:"bold"},children:e.totalMembers})]})}),(0,a.jsx)(s.A,{sx:{backgroundColor:"#1F2937",color:"white"},children:(0,a.jsxs)(n.A,{children:[(0,a.jsx)(i.A,{variant:"h6",sx:{color:"#9CA3AF",mb:2},children:"Mentors"}),(0,a.jsx)(i.A,{variant:"h4",sx:{color:"white",fontWeight:"bold"},children:e.mentors})]})}),(0,a.jsx)(s.A,{sx:{backgroundColor:"#1F2937",color:"white"},children:(0,a.jsxs)(n.A,{children:[(0,a.jsx)(i.A,{variant:"h6",sx:{color:"#9CA3AF",mb:2},children:"Mentees"}),(0,a.jsx)(i.A,{variant:"h4",sx:{color:"white",fontWeight:"bold"},children:e.mentees})]})}),(0,a.jsx)(s.A,{sx:{backgroundColor:"#1F2937",color:"white"},children:(0,a.jsxs)(n.A,{children:[(0,a.jsx)(i.A,{variant:"h6",sx:{color:"#9CA3AF",mb:2},children:"Execs"}),(0,a.jsx)(i.A,{variant:"h4",sx:{color:"white",fontWeight:"bold"},children:e.execs})]})})]}),(0,a.jsxs)(s.A,{sx:{backgroundColor:"#1F2937",color:"white",p:3},children:[(0,a.jsx)(i.A,{variant:"h5",sx:{color:"white",mb:3,fontWeight:600},children:"User Management"}),C&&(0,a.jsx)(l.A,{severity:"error",sx:{mb:2,backgroundColor:"#7F1D1D",color:"white","& .MuiAlert-icon":{color:"white"}},children:C}),M&&(0,a.jsx)(l.A,{severity:"success",sx:{mb:2,backgroundColor:"#14532D",color:"white","& .MuiAlert-icon":{color:"white"}},children:M}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)(c.A,{fullWidth:!0,label:"Search by Email",placeholder:"Enter email address",value:t,onChange:e=>b(e.target.value),onKeyPress:e=>{"Enter"===e.key&&P()},sx:{"& .MuiOutlinedInput-root":{backgroundColor:"#374151",color:"white","& fieldset":{borderColor:"rgba(255, 255, 255, 0.3)"},"&:hover fieldset":{borderColor:"rgba(255, 255, 255, 0.5)"},"&.Mui-focused fieldset":{borderColor:"#76a36d"}},"& .MuiInputLabel-root":{color:"rgba(255, 255, 255, 0.7)"},"& .MuiInputBase-input::placeholder":{color:"rgba(255, 255, 255, 0.5)"}}}),(0,a.jsx)(d.A,{variant:"contained",onClick:P,disabled:E,className:"bg-[#76a36d] hover:bg-[#5d8a55] text-white normal-case",sx:{backgroundColor:"#76a36d","&:hover":{backgroundColor:"#5d8a55"}},children:"Search"})]}),y&&(0,a.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(i.A,{variant:"body2",className:"text-gray-400 mb-1",children:"Name"}),(0,a.jsxs)(i.A,{variant:"body1",className:"text-white",children:[y.first_name," ",y.last_name]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(i.A,{variant:"body2",className:"text-gray-400 mb-1",children:"Email"}),(0,a.jsx)(i.A,{variant:"body1",className:"text-white",children:y.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(i.A,{variant:"body2",className:"text-gray-400 mb-1",children:"Current Role"}),(0,a.jsx)(i.A,{variant:"body1",className:"text-white capitalize",children:y.role})]}),(0,a.jsxs)("div",{className:"flex gap-4 items-end",children:[(0,a.jsxs)(h.A,{fullWidth:!0,children:[(0,a.jsx)(u.A,{sx:{color:"rgba(255, 255, 255, 0.7)"},children:"Change Role"}),(0,a.jsxs)(m.A,{value:v,onChange:e=>j(e.target.value),label:"Change Role",sx:{backgroundColor:"#374151",color:"white","& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.3)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.5)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#76a36d"},"& .MuiSvgIcon-root":{color:"white"}},MenuProps:{PaperProps:{sx:{backgroundColor:"#374151",color:"white","& .MuiMenuItem-root":{color:"white","&:hover":{backgroundColor:"#4B5563"}}}}},children:[(0,a.jsx)(g.A,{value:"default",children:"Default"}),(0,a.jsx)(g.A,{value:"mentor",children:"Mentor"}),(0,a.jsx)(g.A,{value:"mentee",children:"Mentee"}),(0,a.jsx)(g.A,{value:"admin",children:"Admin"})]})]}),(0,a.jsx)(d.A,{variant:"contained",onClick:O,disabled:E||v===y.role,className:"bg-[#6C9A5C] hover:bg-[#8BC677] text-white normal-case",sx:{backgroundColor:"#6C9A5C","&:hover":{backgroundColor:"#8BC677"}},children:E?"Updating...":"Update Role"})]})]})]})]})]})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{}),(0,a.jsx)("div",{className:"py-10 px-5",style:{backgroundColor:"#050a1f",minHeight:"100vh"},children:(0,a.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,a.jsxs)(s.A,{className:"bg-red-900 p-6",children:[(0,a.jsx)(i.A,{variant:"h5",className:"text-white mb-4",children:"Access Denied"}),(0,a.jsx)(i.A,{variant:"body1",className:"text-white mb-2",children:"You need admin privileges to access this page."}),(0,a.jsxs)(i.A,{variant:"body2",className:"text-gray-300",children:["Current status: ",B?"Authenticated":"Not authenticated"]}),(0,a.jsxs)(i.A,{variant:"body2",className:"text-gray-300",children:["Your role: ",U||"none"]}),(0,a.jsx)(i.A,{variant:"body2",className:"text-gray-300 mt-4",children:"Required role: admin"})]})})})]})}},8928:(e,r,t)=>{"use strict";t.d(r,{A:()=>m});var a=t(8526),o=t(5806),s=t(718),i=t(4610),n=t(9758),l=t(5184),c=t(9900);function d(e){return(0,c.Ay)("MuiCardContent",e)}(0,l.A)("MuiCardContent",["root"]);var h=t(8481);let u=(0,i.Ay)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,r)=>r.root})({padding:16,"&:last-child":{paddingBottom:24}}),m=a.forwardRef(function(e,r){let t=(0,n.b)({props:e,name:"MuiCardContent"}),{className:a,component:i="div",...l}=t,c={...t,component:i},m=(e=>{let{classes:r}=e;return(0,s.A)({root:["root"]},d,r)})(c);return(0,h.jsx)(u,{as:i,className:(0,o.A)(m.root,a),ownerState:c,ref:r,...l})})}},e=>{e.O(0,[134,10,279,618,553,97,428,661,59,498,358],()=>e(e.s=2568)),_N_E=e.O()}]);